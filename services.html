---
layout: default
slug:   services
title:  DRDSI Data Harmonisation Pilot - Provision of Direct Access Download services

---

<section>
    <h1><a id="study_intro" class="anchor" href="#mapping" aria-hidden="true"></a>Provision of Direct Access Download services</h1>

    <p>After successfully creating INSPIRE compliant GML data sets, the next step was to make them accessible through WFS interfaces. This includes injecting the data sets into a WFS 2.0 implementation and providing required dataset and service metadata.</p>

    <h2>Publishing Process</h2>
    <p>To publish the resulting INSPIRE GML files we've created, we used a relatively simple solution - a deegree Memory Feature Store. This simple approach only works with relatively small data sets, but is by far the fastest way at the time of this writing to get from a complex GML file to a Web Feature Service 2.0 (INSPIRE Direct Access Download Service) and a Web Map Service 1.3.0 (INSPIRE View Service).</p>
    <p>We used the deegree3 docker image1 and run it according to the instructions on the Github repository. It comes with everything we needed, even for advanced setups with a PostGreSQL database backend.</p>
    <p>First, we have set up deegree's Workspace and a Memory Feature Store as follows.</p>


    <ol>
        <li>
            Start deegree.
        </li>
        <li>
            If you run it locally with default settings, your default browser will be started and will go go to
            the services console. If the automatic launch didn't work, access the console by typing
            <span style="font-family: monospace;">http://localhost:8080</span> in the location bar of your browser. You should now see the console.
        </li>
        <li>
            Click the workspaces link on the left and click the Import link labeled deegree-workspace-
            inspire. This will set up an in-memory feature store as well as create a default configuration for a View and a Download Service. After deegree has finished the download, the new workspace will be listed in section <i style="font-family: monospace">«Available workspaces»</i>.
        </li>
        <li>
            As the deegree-workspace-inspire is pre-configured for standard INSPIRE Annex I themes, we only need to pick the appropriate configuration, e.g. for Administrative Units. Go to <i style="font-family: monospace">«data stores/features»</i> and activate the downloaded workspace by clicking Start. This initializes the workspace and may take a while. When the workspace appears next to <i style="font-family: monospace">«Active workspace»</i>, your deegree service is now running.
        </li>
    </ol>

    <p>After we've set up the workspace and feature store configuration, we need to write the data we've previously transformed to the feature store. We will do so via deegree's Transactional Web Feature Service (WFS-T) capability, directly from hale studio:</p>

    <ol>
        <li>
            In hale, open the transformation project we've created previously.
        </li>
        <li>
            Go to <i style="font-family: monospace">«File»</i>, then to <i style="font-family: monospace">«Export»</i> and <i style="font-family: monospace">«Transformed Data»</i>. Pick <i style="font-family: monospace">«WFS-T (Partitioned Upload)»</i> as
            the export format.
        </li>
        <li>
            In the next screen, click the button «...» to the right of the text entry field labelled «Transaction
            URL». Enter the GetCapabilities URL of your Web Feature Service. Assuming default settings, it will be very similar to <span style="font-family: monospace;">http://localhost:8080/deegree-webservices- 3.3.18/services/AU?service=WFS&version=2.0.0&request=GetCapabilities</span>. hale will automatically derive the Transaction URL from the capabilities.
        </li>
        <li>
            Select WFS Version 2.0.0, and click <i style="font-family: monospace">«Next»</i>
        </li>
        <li>
            Now, we set the GML writer options. You will get the most reliable results when you explicitly
            convert and declare the CRS, and since GML mandates counterclockwise polygon ring orientation, be sure to have these settings:

            <div style="margin: 20px; text-align: center">
                <img src="/images/services.png" title="Example analysis result for a data set" style="height: 350px; width: auto;">
            </div>
        </li>
        <li>
            Click <i style="font-family: monospace">«Next»</i> again, and set the partitioning number. When all your features are small (no big geometries), you can use the default of 15.000, otherwise use a lower number, e.g. 1.000. The settings on the following pages can be left as-is, if you didn't change any of deegree's default settings. Click <i style="font-family: monospace">«Finish»</i> and let the transformation and insertion run.
        </li>
        <li>
            When the transactions have finished, go back to the deegree service console. Here, go to <i style="font-family: monospace">«Home»</i> and click the link <i style="font-family: monospace">«see layers»</i> next to deegree-workspace-inspire. You should then see a map.
        </li>
    </ol>

    <h2>Example Services</h2>

    <p>We’ve also set up some live example services:</p>

    <p style="font-weight: bold; color: black">Moldova Example Services for INSPIRE Administrative Units 4.0:</p>
    <ul>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.12.08b11e89-0231-4cdb-abee-f604995847df/wmsclient">View Service</a> (WMS Client)</li>
        <li><a href="https://deegree.inspire-gis.eu/services/org.12.08b11e89-0231-4cdb-abee-f604995847df_wms?SERVICE=WMS&REQUEST=GetCapabilities&VERSION=1.1.1">View Service</a> (WMS GetCapabilities)</li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.12.08b11e89-0231-4cdb-abee-f604995847df/service/atom/id_predefined_dataset">Predefined Dataset Download Service</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.12.08b11e89-0231-4cdb-abee-f604995847df/md/dataset/dataset1">Dataset metadata</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.12.08b11e89-0231-4cdb-abee-f604995847df/md/service/id_wms">View Service metadata</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.12.08b11e89-0231-4cdb-abee-f604995847df/md/service/id_predefined_dataset">Download Service metadata</a></li>
    </ul>

    <p style="font-weight: bold; color: black">Ukraine Example Services for INSPIRE Administrative Units 4.0:</p>
    <ul>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.13.bef5a828-e452-4563-8f43-db2335db00a2/wmsclient">View Service</a> (WMS Client)</li>
        <li><a href="https://deegree.inspire-gis.eu/services/org.13.bef5a828-e452-4563-8f43-db2335db00a2_wms?SERVICE=WMS&REQUEST=GetCapabilities&VERSION=1.1.1">View Service</a> (WMS GetCapabilities)</li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.13.bef5a828-e452-4563-8f43-db2335db00a2/service/atom/id_predefined_dataset">Predefined Dataset Download Service</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.13.bef5a828-e452-4563-8f43-db2335db00a2/md/dataset/dataset1">Dataset metadata</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.13.bef5a828-e452-4563-8f43-db2335db00a2/md/service/id_wms">View Service metadata</a></li>
        <li><a href="https://bsp.inspire-gis.eu/bsp/org.13.bef5a828-e452-4563-8f43-db2335db00a2/md/service/id_predefined_dataset">Download Service metadata</a></li>
    </ul>

</section>
